Каждые 2 минуты (+- 30сек) в папку 'In' файловой системы поступает файл в формате csv все поля обязательные
имя файла в формате '20201129_1234_DME.csv' - '<год><месяц><день>_<номер рейса>_<аэропорт вылета>.csv'
num;surname;firstname;bdate
1;IVANOV;IVAN;11NOV73
2;PETROV;ALEXANDER;13JUL79
3;BOSHIROV;RUSLAN;12APR78
Необходимо при появлении файла в папке как можно скорее преобразовать файл в формат json и сохранить его в папке 'Out'
значения в json: 'date' (строка дата в формате ISO), 'flt' (число), 'dep' (строка) необходимо взять из имени файла
prl - список словарей с данными из csv файла с именами, взятыми из первой строки csv файла
{
    "flt": 1234,
    "date": "2020-11-29",
    "dep": "DME",
    "prl": [
        {
            "num": "1",
            "surname": "IVANOV",
            "firstname": "IVAN",
            "bdate": "1973-11-11"
        },
        {
            "num": "2",
            "surname": "PETROV",
            "firstname": "ALEXANDER",
            "bdate": "1979-07-13"
        },
        {
            "num": "3",
            "surname": "BOSHIROV",
            "firstname": "RUSLAN",
            "bdate": "1978-04-12"
        }
    ]
}
Исходный файл переместить в папку 'Ok'
В случае возникновения ошибок файл переместить в папку 'Err'
Одновременно создать запись в таблице 'flight' базы данных sqlite (или другую SQL базу)
Содержащих поля:
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  file_name TEXT NOT NULL, – имя полученого файла
  flt INTEGER NOT NULL,  --номер рейса
  depdate DATE NOT NULL, --дата рейса
  dep TEXT NOT NULL --аэропорт вылета

Базу данных и таблицу 'flight' создать при первом запуске программы
Выводить в консоль лог всех действий программы
Написать SQL запрос для выборки из таблицы 'flight' всех рейсов за определённую дату
Ответить на вопрос: что нужно сделать что бы запрос на выборку работал быстрее когда в таблице будет очень много записей?
p.s. Необходимо как-то обосновать выбор тех или иных библиотек использованных при реализации, выбор библиотек остаётся за разработчиком
